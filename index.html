<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>安管家預約表單</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      background-color: #e9e2da;
      color: #1b2a42;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #1b2a42;
    }
    form {
      max-width: 900px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 16px;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background-color: #1b2a42;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      margin-top: 24px;
      cursor: pointer;
    }
    button:hover {
      background-color: #c6b699;
    }
    .hidden {
      display: none;
    }
    .checkbox-group label {
      display: inline-block;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <h1>安管家照護預約表單</h1>
<section id="section-user-info">
  <h2>一、使用者基本資料</h2>

  <label for="name">使用者姓名</label>
  <input type="text" id="name" name="name" required>

  <label for="age">年齡</label>
  <input type="number" id="age" name="age" required>

  <label for="height">身高（cm）</label>
  <input type="number" id="height" name="height" required>

  <label for="weight">體重（kg）</label>
  <input type="number" id="weight" name="weight" required>

  <label for="gender">性別</label>
  <select id="gender" name="gender" required>
    <option value="">請選擇</option>
    <option value="男">男</option>
    <option value="女">女</option>
  </select>
</section>

<section id="section-health-status">
  <h2>二、健康狀況與照護資訊</h2>

  <label for="diseaseHistory">疾病史</label>
  <textarea id="diseaseHistory" name="diseaseHistory" rows="2" required></textarea>

  <label for="allergy">過敏史</label>
  <textarea id="allergy" name="allergy" rows="2" required></textarea>

  <label>使用管路（可複選）</label>
  <div class="checkbox-group">
    <label><input type="checkbox" name="tubes" value="無" required>無</label>
    <label><input type="checkbox" name="tubes" value="鼻胃管">鼻胃管</label>
    <label><input type="checkbox" name="tubes" value="氣切">氣切</label>
    <label><input type="checkbox" name="tubes" value="導尿管">導尿管</label>
    <label><input type="checkbox" name="tubes" value="造瘻口">造瘻口</label>
  </div>

  <label for="cognitive">認知狀態</label>
  <select id="cognitive" name="cognitive" required>
    <option value="">請選擇</option>
    <option value="正常">正常</option>
    <option value="輕度退化">輕度退化</option>
    <option value="中重度退化">中重度退化</option>
  </select>

  <label for="certification">領有證明手冊</label>
  <select id="certification" name="certification" required>
    <option value="">請選擇</option>
    <option value="無">無</option>
    <option value="失智症手冊">失智症手冊</option>
    <option value="身障手冊">身障手冊</option>
  </select>

  <label for="bodyStatus">身體狀況</label>
  <textarea id="bodyStatus" name="bodyStatus" rows="2" required></textarea>

  <label for="dietType">飲食方式</label>
  <select id="dietType" name="dietType" required>
    <option value="">請選擇</option>
    <option value="正常飲食">正常飲食</option>
    <option value="流質">流質</option>
    <option value="半流質">半流質</option>
    <option value="鼻胃管灌食">鼻胃管灌食</option>
    <option value="其他">其他</option>
  </select>
</section>

<section id="section-service-selection">
  <h2>三、服務選擇與需求條件</h2>

  <label for="category">預約類別</label>
  <select id="category" name="category" required>
    <option value="">請選擇</option>
    <option value="care">照顧人力</option>
    <option value="course">紓壓／課程</option>
  </select>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const categorySelect = document.getElementById("category");
  const serviceSelect = document.getElementById("service");

  const serviceOptions = {
    care: ["急診陪伴員", "特別護理師", "高階管家", "自費看護", "居家照顧人員", "家事人員"],
    course: ["居家護理師", "指導外籍看護照顧技巧", "指導肌力核心訓練", "芳療紓壓"]
  };

  categorySelect.addEventListener("change", function () {
    const selectedCategory = this.value;
    serviceSelect.innerHTML = ""; // 清空原本選項

    if (selectedCategory && serviceOptions[selectedCategory]) {
      const defaultOption = document.createElement("option");
      defaultOption.value = "";
      defaultOption.textContent = "請選擇服務項目";
      serviceSelect.appendChild(defaultOption);

      serviceOptions[selectedCategory].forEach(service => {
        const option = document.createElement("option");
        option.value = service;
        option.textContent = service;
        serviceSelect.appendChild(option);
      });
    } else {
      const emptyOption = document.createElement("option");
      emptyOption.value = "";
      emptyOption.textContent = "請先選擇預約類別";
      serviceSelect.appendChild(emptyOption);
    }
  });
});
</script>


  <label for="careFocus">照護／協助重點</label>
  <textarea id="careFocus" name="careFocus" rows="2" required></textarea>

  <div id="scopeGroup" class="hidden">
    <label>範圍（可複選）</label>
    <div class="checkbox-group">
      <label><input type="checkbox" name="scope" value="客廳">客廳</label>
      <label><input type="checkbox" name="scope" value="廚房">廚房</label>
      <label><input type="checkbox" name="scope" value="臥室">臥室</label>
      <label><input type="checkbox" name="scope" value="廁所">廁所</label>
      <label><input type="checkbox" name="scope" value="陽台">陽台</label>
      <label><input type="checkbox" name="scope" value="書房">書房</label>
      <label><input type="checkbox" name="scope" value="更衣室">更衣室</label>
    </div>
  </div>

  <div id="houseworkContentGroup" class="hidden">
    <label>服務內容（可複選）</label>
    <div class="checkbox-group">
      <label><input type="checkbox" name="houseworkContent" value="居家清潔、整理、收納、保養">居家清潔、整理、收納、保養</label>
      <label><input type="checkbox" name="houseworkContent" value="基本炊事調理">基本炊事調理</label>
      <label><input type="checkbox" name="houseworkContent" value="洗燙衣服務及收納">洗燙衣服務及收納</label>
      <label><input type="checkbox" name="houseworkContent" value="大掃除">大掃除</label>
    </div>
  </div>

  <div id="goalGroup" class="hidden">
    <label for="goal">目標</label>
    <textarea id="goal" name="goal" rows="2" required></textarea>
  </div>

  <div id="physicianConsentGroup" class="hidden">
    <label for="physicianConsent">已徵求醫師建議／同意？</label>
    <select id="physicianConsent" name="physicianConsent" required>
      <option value="">請選擇</option>
      <option value="是">是</option>
      <option value="否">否</option>
    </select>
  </div>

  <div id="petGroup" class="hidden">
    <label for="pet">是否有寵物？</label>
    <select id="pet" name="pet" required>
      <option value="">請選擇</option>
      <option value="是">是</option>
      <option value="否">否</option>
    </select>
  </div>

  <div id="mealGroup" class="hidden">
    <label for="meal">是否提供用餐？</label>
    <select id="meal" name="meal" required>
      <option value="">請選擇</option>
      <option value="是">是（酌收 200 元/天）</option>
      <option value="否">否</option>
    </select>
  </div>

  <div id="languageGroup" class="hidden">
    <label>語言（可複選）</label>
    <div class="checkbox-group">
      <label><input type="checkbox" name="language" value="國語">國語</label>
      <label><input type="checkbox" name="language" value="台語">台語</label>
      <label><input type="checkbox" name="language" value="客語">客語</label>
      <label><input type="checkbox" name="language" value="英文">英文</label>
    </div>
  </div>
</section>

<section id="section-service-time">
  <h2>四、服務時間與期望條件</h2>

  <label for="startDate">預計開始服務日期</label>
  <input type="date" id="startDate" name="startDate" required>

  <label for="days">預計服務天數</label>
  <input type="number" id="days" name="days" min="1" required>

  <label for="time">上班時間</label>
  <select id="time" name="time" required>
    <option value="">請選擇</option>
    <option value="白班">白班</option>
    <option value="晚班">晚班</option>
    <option value="夜班">夜班</option>
    <option value="過夜">過夜</option>
  </select>

  <div id="careFrequencyGroup" class="hidden">
    <label for="careFrequency">照顧人力頻率</label>
    <select id="careFrequency" name="careFrequency">
      <option value="">請選擇</option>
      <option value="短期">短期</option>
      <option value="長期">長期</option>
    </select>
  </div>

  <div id="courseFrequencyGroup" class="hidden">
    <label for="courseFrequency">課程類頻率</label>
    <select id="courseFrequency" name="courseFrequency">
      <option value="">請選擇</option>
      <option value="短期">短期</option>
      <option value="長期">長期</option>
    </select>
  </div>

  <div id="houseworkFrequencyGroup" class="hidden">
    <label for="houseworkFrequency">家事服務頻率</label>
    <select id="houseworkFrequency" name="houseworkFrequency">
      <option value="">請選擇</option>
      <option value="短期">短期</option>
      <option value="長期">長期</option>
    </select>
  </div>

  <label>期待時段（可複選）</label>
  <div class="checkbox-group">
    <label><input type="checkbox" name="expectedTimes" value="上午">上午</label>
    <label><input type="checkbox" name="expectedTimes" value="中午">中午</label>
    <label><input type="checkbox" name="expectedTimes" value="下午">下午</label>
    <label><input type="checkbox" name="expectedTimes" value="傍晚">傍晚</label>
  </div>

  <label for="hours">每日服務時數</label>
  <input type="number" id="hours" name="hours" min="1" required>

  <div id="courseDaysGroup" class="hidden">
    <label>期待上課星期（可複選）</label>
    <div class="checkbox-group">
      <label><input type="checkbox" name="preferredDays" value="一">星期一</label>
      <label><input type="checkbox" name="preferredDays" value="二">星期二</label>
      <label><input type="checkbox" name="preferredDays" value="三">星期三</label>
      <label><input type="checkbox" name="preferredDays" value="四">星期四</label>
      <label><input type="checkbox" name="preferredDays" value="五">星期五</label>
      <label><input type="checkbox" name="preferredDays" value="六">星期六</label>
      <label><input type="checkbox" name="preferredDays" value="日">星期日</label>
    </div>
  </div>

  <label for="holiday">是否假日服務</label>
  <select id="holiday" name="holiday" required>
    <option value="">請選擇</option>
    <option value="可">可</option>
    <option value="否">否</option>
  </select>
</section>

<section id="section-medical-contact">
  <h2>五、醫療與緊急聯絡資訊</h2>

  <label for="hospital">服務醫院地點</label>
  <input type="text" id="hospital" name="hospital" placeholder="請輸入醫院名稱或地點" required>

  <label for="reason">送醫原因</label>
  <input type="text" id="reason" name="reason" placeholder="例如：跌倒、呼吸困難、定期追蹤..." required>

  <label for="contactName">主要聯絡人姓名</label>
  <input type="text" id="contactName" name="contactName" placeholder="請輸入主要聯絡人姓名" required>

  <label for="contactPhone">主要聯絡人電話</label>
  <input type="tel" id="contactPhone" name="contactPhone" placeholder="例如：0912345678" pattern="[0-9]{10}" required>
</section>

<section id="section-location-note">
  <h2>六、服務地點與備註</h2>

  <label for="county">服務地點－縣市</label>
  <input type="text" id="county" name="county" placeholder="請輸入服務地點的縣市" required>

  <label for="town">服務地點－區域</label>
  <input type="text" id="town" name="town" placeholder="請輸入服務地點的鄉鎮或行政區" required>

  <label for="address">服務地點－詳細地址</label>
  <input type="text" id="address" name="address" placeholder="請輸入完整地址（含門牌號）" required>

  <label for="note">備註</label>
  <textarea id="note" name="note" rows="4" placeholder="額外說明或特殊需求" required></textarea>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("bookingForm");
  const reviewSection = document.getElementById("reviewSection");
  const reviewContent = document.getElementById("reviewContent");
  const confirmSubmit = document.getElementById("confirmSubmit");
  const editForm = document.getElementById("editForm");

  // 攔截表單第一次送出
  form.addEventListener("submit", function (e) {
    e.preventDefault();

    // 收集表單資料
    const formData = new FormData(form);
    const data = {};
    formData.forEach((value, key) => {
      if (key.includes("[]")) {
        const actualKey = key.replace("[]", "");
        if (!data[actualKey]) data[actualKey] = [];
        data[actualKey].push(value);
      } else if (data[key]) {
        if (!Array.isArray(data[key])) data[key] = [data[key]];
        data[key].push(value);
      } else {
        data[key] = value;
      }
    });

    // 顯示確認內容
    let html = "<ul>";
    for (const [key, value] of Object.entries(data)) {
      html += `<li><strong>${key}：</strong>${Array.isArray(value) ? value.join(", ") : value}</li>`;
    }
    html += "</ul>";
    reviewContent.innerHTML = html;

    // 隱藏表單，顯示確認頁
    form.classList.add("hidden");
    reviewSection.classList.remove("hidden");

    // 暫存資料
    form.dataset.tempData = JSON.stringify(data);
  });

  // 按下「再修改」
  editForm.addEventListener("click", () => {
    reviewSection.classList.add("hidden");
    form.classList.remove("hidden");
  });

  // 確認送出
  confirmSubmit.addEventListener("click", () => {
    const data = JSON.parse(form.dataset.tempData);
    fetch("https://script.google.com/macros/s/AKfycbxgJc4qWs34qlUrbpwke4Jd6GFE4VBGlffuVb9pT08Jsj0OkCggAMbNo0WW3WuPft0_/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    reviewContent.innerHTML = "<p>✅ 預約成功，安管家將盡快與您聯繫！</p>";
    confirmSubmit.remove();
    editForm.remove();
  });
});
</script>
