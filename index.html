<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>安管家預約表單</title>
  <style>
    body {
      font-family: "Noto Sans TC", sans-serif;
      background-color: #e9e2da;
      color: #1b2a42;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #1b2a42;
    }
    form {
      max-width: 900px;
      margin: 0 auto;
      background-color: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 16px;
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background-color: #1b2a42;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      margin-top: 24px;
      cursor: pointer;
    }
    button:hover {
      background-color: #c6b699;
    }
    .hidden {
      display: none;
    }
    .checkbox-group label {
      display: inline-block;
      margin-right: 10px;
    }
  </style>
</head>
<body>
  <h1>安管家照護預約表單</h1>
  <form id="bookingForm">
    <label>預約類別</label>
    <select name="category" id="category" required>
      <option value="">請選擇</option>
      <option value="care">照顧人力</option>
      <option value="course">紓壓／課程</option>
    </select>

    <label>服務項目</label>
    <select name="service" id="service" required>
      <option value="">請先選擇預約類別</option>
    </select>

    <label>使用者姓名</label>
    <input type="text" name="name" required />

    <label>年齡</label>
    <input type="number" name="age" />

    <label>身高 (cm)</label>
    <input type="number" name="height" />

    <label>體重 (kg)</label>
    <input type="number" name="weight" />

    <label>性別</label>
    <select name="gender">
      <option value="">請選擇</option>
      <option value="男">男</option>
      <option value="女">女</option>
    </select>

    <label>疾病史</label>
    <textarea name="diseaseHistory" rows="2"></textarea>

    <!-- 照顧人力專屬區塊 -->
    <div id="careFields" class="hidden">
      <label>開始上班日</label>
      <input type="date" name="startDate" />

      <label>需求天數</label>
      <input type="number" name="days" />

      <label>每日上班時間</label>
      <input type="time" name="time" />


    <div id="courseDetails" class="hidden">
      <label>頻率</label>
      <select name="courseFrequency">
        <option value="">請選擇</option>
        <option value="短期">短期</option>
        <option value="長期">長期</option>
      </select>

      <label>時段（可複選）</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="courseTimes" value="上午">上午</label>
        <label><input type="checkbox" name="courseTimes" value="中午">中午</label>
        <label><input type="checkbox" name="courseTimes" value="下午">下午</label>
        <label><input type="checkbox" name="courseTimes" value="傍晚">傍晚</label>
      </div>
    </div>

      <label>每日服務時數</label>
      <select name="hours">
        <option value="">請選擇</option>
        <option value="2小時">2小時</option>
        <option value="4小時">4小時</option>
        <option value="8小時">8小時</option>
        <option value="10小時">10小時</option>
        <option value="12小時">12小時</option>
        <option value="24小時">24小時</option>
      </select>

      <div id="houseworkOptions" class="hidden">
        <label>服務內容（可複選）</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="housework" value="打掃">打掃</label>
          <label><input type="checkbox" name="housework" value="洗衣">洗衣</label>
          <label><input type="checkbox" name="housework" value="備餐">備餐</label>
          <label><input type="checkbox" name="housework" value="大掃除(請至備註輸入範圍)">大掃除(請至備註輸入範圍)</label>
        </div>
      </div>

        <label>語言（可複選）</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="language" value="國語">國語</label>
          <label><input type="checkbox" name="language" value="台語">台語</label>
          <label><input type="checkbox" name="language" value="客語">客語</label>
          <label><input type="checkbox" name="language" value="英文">英文</label>
        </div>

        <label>使用管路（可複選）</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="tubes" value="無">無</label>
          <label><input type="checkbox" name="tubes" value="鼻胃管">鼻胃管</label>
          <label><input type="checkbox" name="tubes" value="氣切">氣切</label>
          <label><input type="checkbox" name="tubes" value="導尿管">導尿管</label>
          <label><input type="checkbox" name="tubes" value="造瘻口">造瘻口</label>
        </div>

        <label>照護重點</label>
        <textarea name="careFocus" rows="2"></textarea>

        <label>認知狀態</label>
        <select name="cognitive">
          <option value="">請選擇</option>
          <option value="正常">正常</option>
          <option value="輕度退化">輕度退化</option>
          <option value="中重度退化">中重度退化</option>
        </select>

        <label>領有證明手冊</label>
        <select name="certification">
          <option value="">請選擇</option>
          <option value="無">無</option>
          <option value="失智症手冊">失智症手冊</option>
          <option value="身障手冊">身障手冊</option>
        </select>
      </div>

      <label>提供照服員用餐</label>
      <select name="meal">
        <option value="">請選擇</option>
        <option value="是(將酌收200元/天)">是</option>
        <option value="否">否</option>
      </select>
    </div>

    <!-- 課程專屬 -->
    <div id="courseFields" class="hidden">
      <label>期待上課星期（可複選）</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="preferredDays" value="週一">週一</label>
        <label><input type="checkbox" name="preferredDays" value="週二">週二</label>
        <label><input type="checkbox" name="preferredDays" value="週三">週三</label>
        <label><input type="checkbox" name="preferredDays" value="週四">週四</label>
        <label><input type="checkbox" name="preferredDays" value="週五">週五</label>
        <label><input type="checkbox" name="preferredDays" value="週六">週六</label>
        <label><input type="checkbox" name="preferredDays" value="週日">週日</label>
      </div>
    </div>

    <label>假日服務</label>
    <select name="holiday">
      <option value="">請選擇</option>
      <option value="是">是</option>
      <option value="否">否</option>
    </select>

    <label>縣市</label>
    <input type="text" name="county" required />

    <label>鄉鎮</label>
    <input type="text" name="town" required />

    <label>地址</label>
    <input type="text" name="address" required />

    <label>備註</label>
    <textarea name="note" rows="4"></textarea>

    <button type="submit">送出預約</button>
  </form>

<script>
  const serviceOptions = {
    care: ["急診陪伴員", "特別護理師", "高階管家", "自費看護", "居家照顧人員", "家事人員"],
    course: ["居家護理師", "指導外籍看護照顧技巧", "指導肌力核心訓練", "芳療紓壓"]
  };

  const notePresets = {
    "急診陪伴員": "\n送醫原因：\n醫院地點：\n特殊備註：",
    "特別護理師": "\n目前使用管路：（如鼻胃管、氣切、導尿管等）\n照護重點：\n備註：",
    "高階管家": "\n目前使用管路：（如鼻胃管、氣切、導尿管等）\n照護重點：\n認知狀態：\n日常活動安排需求：\n身體狀況與飲食作息：\n語言溝通方式：\n備註：",
    "自費看護": "\n目前使用管路：\n照護重點：\n認知狀態：\n照顧需求：\n備註：",
    "居家照顧人員": "\n目前使用管路：\n照護重點：\n認知狀態：\n照顧需求：\n備註：",
    "家事人員": "\n服務內容：\n是否有寵物：\n備註：",
    "居家護理師": "\n服務需求：\n備註：",
    "指導外籍看護照顧技巧": "\n看護來台經驗與語言能力：\n期待指導內容：\n備註：",
    "指導肌力核心訓練": "\n是否臥床：\n目標：\n場地描述：\n備註：",
    "芳療紓壓": "\n紓壓對象：(照顧者/被照顧者)\n身心狀況：\n過敏史：\n是否已向醫師同意/建議：\n備註："
  };

  const courseExtraFields = ["居家護理師", "指導外籍看護照顧技巧", "指導肌力核心訓練", "芳療紓壓"];
  const careRoles = ["急診陪伴員", "特別護理師", "高階管家", "自費看護", "居家照顧人員"];

  document.addEventListener("DOMContentLoaded", () => {
    const category = document.getElementById("category");
    const service = document.getElementById("service");
    const note = document.querySelector("textarea[name='note']");
    const houseworkOptions = document.getElementById("houseworkOptions");
    const nursingDetails = document.getElementById("nursingDetails");
    const courseDetails = document.getElementById("courseDetails");

    category.addEventListener("change", () => {
      const type = category.value;
      const options = serviceOptions[type] || [];
      service.innerHTML = '<option value="">請選擇服務項目</option>';
      options.forEach(s => {
        const opt = document.createElement("option");
        opt.value = s;
        opt.textContent = s;
        service.appendChild(opt);
      });

      document.getElementById("careFields").classList.toggle("hidden", type !== "care");
      document.getElementById("courseFields").classList.toggle("hidden", type !== "course");
      note.value = "";
      houseworkOptions.classList.add("hidden");
      nursingDetails.classList.add("hidden");
      courseDetails.classList.add("hidden");
    });

    service.addEventListener("change", () => {
      const val = service.value;
      note.value = notePresets[val] || "";
      houseworkOptions.classList.toggle("hidden", val !== "家事人員");
      nursingDetails.classList.toggle("hidden", !careRoles.includes(val));
      courseDetails.classList.toggle("hidden", !courseExtraFields.includes(val));
    });

    document.getElementById("bookingForm").addEventListener("submit", function (e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const data = {};
      formData.forEach((value, key) => {
        if (["preferredDays", "courseTimes", "language", "housework", "tubes"].includes(key)) {
          if (!data[key]) data[key] = [];
          data[key].push(value);
        } else if (data[key]) {
          if (!Array.isArray(data[key])) data[key] = [data[key]];
          data[key].push(value);
        } else {
          data[key] = value;
        }
      });

      fetch("https://script.google.com/macros/s/AKfycbxgJc4qWs34qlUrbpwke4Jd6GFE4VBGlffuVb9pT08Jsj0OkCggAMbNo0WW3WuPft0_/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      alert("預約成功，我們將盡快與您聯繫！");
      e.target.reset();
    });
  });
</script>
